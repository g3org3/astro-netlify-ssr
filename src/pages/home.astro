---
import Button from "../components/Button";
import Table from "../components/Table";
import Layout from "../layouts/Layout.astro";

const val = Astro.cookies.get("SID").value;

if (!val) {
  return Astro.redirect("/");
}
const url = `https://rickandmortyapi.com/api/character/${val}`;
const res = await fetch(url);
const user = (await res.json()) as {
  name: string;
  image: string;
  status: string;
  location?: { name: string };
};
---

<Layout title="APP | HOME">
  <div class="flex flex-col flex-1 bg-white overflow-auto">
    <div class="bg-indigo-800 p-2 flex flex-row-reverse shadow-lg">
      <div class="mx-auto items-center container px-4 flex">
        <span class="flex items-center gap-2 text-white text-2xl">
          <img
            alt="profile picture"
            class="h-10 rounded-full"
            src={user.image}
          />
          {user.name}
        </span>
        <div class="flex-1"></div>
        <Button client:load />
      </div>
    </div>
    <div class="container mx-auto p-4 flex-1 flex flex-col overflow-auto">
      <h1 class="text-3xl">Welcome {user.name}!</h1>
      <div>{user?.location?.name}</div>
      <p class="text-justify">
        I'm baby roof party cliche cronut cray hammock jean shorts photo booth
        kinfolk keytar. Small batch YOLO bushwick succulents, forage organic
        tote bag knausgaard readymade coloring book. Knausgaard distillery
        humblebrag bitters same coloring book polaroid ethical ramps. Art party
        ethical gluten-free thundercats church-key microdosing kombucha lo-fi
        XOXO PBR&B. Retro flexitarian kitsch, neutral milk hotel crucifix
        asymmetrical meggings selvage gluten-free glossier quinoa cornhole. You
        probably haven't heard of them poutine offal flexitarian williamsburg
        big mood. Iceland cray echo park deep v, retro squid same edison bulb
        tilde woke.
      </p>
      <Table client:load />
    </div>
  </div>
</Layout>

<style></style>
